<!-- <div class="px-4 pt-4 mb-1">
  <dfs-select-slate></dfs-select-slate>
</div> -->

<mat-stepper #stepper>
  <mat-step [stepControl]="qbSelectionFormGroup">
    <form [formGroup]="qbSelectionFormGroup">
      <ng-template matStepLabel>Select 4-6 QBs</ng-template>

      @if (isLoading()) {
      <div>Loading available players...</div>
      } @else {
      <mat-selection-list
        #qbs
        class="max-h-[385px] overflow-scroll rounded"
        formControlName="qbPoolCtrl"
      >
        @for (qb of availableQuarterbacks(); track qb.id) {
        <mat-list-option [selected]="qb.isSelectedForPlayerPool" [value]="qb">
          <span class="qb-text-color mr-3">QB</span>
          <span class="font-bold">{{ qb.name }}</span>
          <span class="ml-2 text-slate-300 text-sm">{{ qb.gameInfo }}</span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ qb.salary | currency : 'USD' : 'symbol' : '1.0-0' }}
          </span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ qb.projectedPointsPerDollar | number : '1.3-3' }}
            <span class="text-xs">PTS/$100</span>
          </span>
        </mat-list-option>
        }
      </mat-selection-list>

      <dfs-sort-player-pool
        class="block mt-4"
        [position]="position.QB"
        [quarterbacks]="selectedQuarterbacks()"
        (selectPlayersBasedOnProjections)="
          selectPlayersBasedOnProjections($event)
        "
      ></dfs-sort-player-pool>

      <div class="mt-1">
        <button
          (click)="saveQbSelections()"
          [disabled]="!qbSelectionFormGroup.valid"
          matButton
          matStepperNext
        >
          Next
        </button>
      </div>
      }
    </form>
  </mat-step>
  <mat-step [stepControl]="rbSelectionFormGroup" label="Select 8-16 RBs">
    <form [formGroup]="rbSelectionFormGroup">
      <mat-selection-list
        #rbs
        class="max-h-[385px] overflow-scroll rounded"
        formControlName="rbPoolCtrl"
      >
        @for (rb of availableRunningBacks(); track rb.id) {
        <mat-list-option [selected]="rb.isSelectedForPlayerPool" [value]="rb">
          <span class="rb-text-color mr-3">RB</span>
          <span class="font-bold">{{ rb.name }}</span>
          <span class="ml-2 text-slate-300 text-sm">{{ rb.gameInfo }}</span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ rb.salary | currency : 'USD' : 'symbol' : '1.0-0' }}
          </span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ rb.projectedPointsPerDollar | number : '1.3-3' }} PTS/$100
          </span>
        </mat-list-option>
        }
      </mat-selection-list>

      <dfs-sort-player-pool
        class="block mt-4"
        [position]="position.RB"
        [runningBacks]="selectedRunningBacks()"
        (selectPlayersBasedOnProjections)="
          selectPlayersBasedOnProjections($event)
        "
      ></dfs-sort-player-pool>
      <div class="mt-1">
        <button matButton matStepperPrevious>Back</button>
        <button
          (click)="saveRBSelections()"
          [disabled]="!rbSelectionFormGroup.valid"
          matButton
          matStepperNext
        >
          Next
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="wrSelectionFormGroup" label="Select 35-50 WRs">
    <form [formGroup]="wrSelectionFormGroup">
      <mat-selection-list
        #wrs
        class="max-h-[385px] overflow-scroll rounded"
        formControlName="wrPoolCtrl"
      >
        @for (wr of availableWideReceivers(); track wr.id) {
        <mat-list-option [selected]="wr.isSelectedForPlayerPool" [value]="wr">
          <span class="wr-text-color mr-3">WR</span>
          <span class="font-bold">{{ wr.name }}</span>
          <span class="ml-2 text-slate-300 text-sm">{{ wr.gameInfo }}</span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ wr.salary | currency : 'USD' : 'symbol' : '1.0-0' }}
          </span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ wr.projectedPointsPerDollar | number : '1.3-3' }} PTS/$100
          </span>
        </mat-list-option>
        }
      </mat-selection-list>

      <dfs-sort-pass-catcher-pool
        class="block mt-4"
        [passCatchers]="selectedWideReceivers()"
        [position]="position.WR"
        (selectPlayersBasedOnProjections)="
          selectPlayersBasedOnProjections($event)
        "
      ></dfs-sort-pass-catcher-pool>

      <div class="mt-1">
        <button matButton matStepperPrevious>Back</button>
        <button
          (click)="saveWRSelections()"
          [disabled]="!wrSelectionFormGroup.valid"
          matButton
          matStepperNext
        >
          Next
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="teSelectionFormGroup" label="Select 7-15 TEs">
    <form [formGroup]="teSelectionFormGroup">
      <mat-selection-list
        #tes
        class="max-h-[385px] overflow-scroll rounded"
        formControlName="tePoolCtrl"
      >
        @for (te of availableTightEnds(); track te.id) {
        <mat-list-option [selected]="te.isSelectedForPlayerPool" [value]="te">
          <span class="te-text-color mr-3">TE</span>
          <span class="font-bold">{{ te.name }}</span>
          <span class="ml-2 text-slate-300 text-sm">{{ te.gameInfo }}</span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ te.salary | currency : 'USD' : 'symbol' : '1.0-0' }}
          </span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ te.projectedPointsPerDollar | number : '1.3-3' }} PTS/$100
          </span>
        </mat-list-option>
        }
      </mat-selection-list>

      <dfs-sort-pass-catcher-pool
        class="block mt-4"
        [passCatchers]="selectedTightEnds()"
        [position]="position.TE"
        (selectPlayersBasedOnProjections)="
          selectPlayersBasedOnProjections($event)
        "
      ></dfs-sort-pass-catcher-pool>

      <div class="mt-1">
        <button matButton matStepperPrevious>Back</button>
        <button
          (click)="saveTightEndSelections()"
          [disabled]="!teSelectionFormGroup.valid"
          matButton
          matStepperNext
        >
          Next
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="dstSelectionFormGroup" label="Select 8-12 DSTs">
    <form [formGroup]="dstSelectionFormGroup">
      <mat-selection-list
        #dsts
        class="max-h-[385px] overflow-scroll rounded"
        formControlName="dstPoolCtrl"
      >
        @for (dst of availableDsts(); track dst.id) {
        <mat-list-option [selected]="dst.isSelectedForPlayerPool" [value]="dst">
          <span class="dst-text-color mr-3">DST</span>
          <span class="font-bold">{{ dst.name }}</span>
          <span class="ml-2 text-slate-300 text-sm">{{ dst.gameInfo }}</span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ dst.salary | currency : 'USD' : 'symbol' : '1.0-0' }}
          </span>
          &bull;
          <span class="text-slate-300 text-sm">
            {{ dst.projectedPointsPerDollar | number : '1.3-3' }} PTS/$100
          </span>
        </mat-list-option>
        }
      </mat-selection-list>

      <dfs-sort-player-pool
        class="block mt-4"
        [dsts]="selectedDefenses()"
        [position]="position.DST"
        (selectPlayersBasedOnProjections)="
          selectPlayersBasedOnProjections($event)
        "
      ></dfs-sort-player-pool>

      <div class="mt-1">
        <button matButton matStepperPrevious>Back</button>
        <button
          (click)="saveDSTSelections()"
          [disabled]="!dstSelectionFormGroup.valid"
          matButton
          matStepperNext
        >
          Next
        </button>
      </div>
    </form>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>QB Stacks</ng-template>

    <div>
      <dfs-qb-pass-catcher-ownership></dfs-qb-pass-catcher-ownership>

      <button matButton matStepperPrevious>Back</button>
      <button matButton (click)="generateLineupBuilders()">
        Generate Lineup Builders
      </button>
    </div>
  </mat-step>
</mat-stepper>
